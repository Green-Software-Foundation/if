name: msft-eshoppen
description: https://github.com/Green-Software-Foundation/sci-guide/blob/dev/use-case-submissions/msft-eShoppen.md
tags:
  kind: web
  complexity: moderate
  category: cloud
config:
  funit:
    - name: requests
      scale-factor: 500 # divide SCi per hour by this to get SCI per request
  models:
    - name: sci-m # a model that calculates m from te, tir, el, rr and rtor
      path: builtin  
    - name: sci-c # a model that given e, i and m calculates a carbon value (e * i) + m
      path: builtin             
    - name: teads-curve # a model that returns energy based on the generalised teads power curve and tdp
      path: builtin
graph:
  front-end:
    pipeline: 
      - teads-curve # tdp & cpu -> energy
      - sci-m # duration & config -> embodied
      - sci-c # energy & grid-carbon-intensity & embodied -> carbon
    config:
      sci-m:
        te: 350 # kgCO2eq
        tir: "duration" # get this value from the duration field
        el: 126144000 # 4 years in seconds        
        rr: 1
        tor: 1
      sci-c:
        i: 951 # gCO2e/kWh
      teads-curve:
        processor: Intel® Core™ i7-1185G7
        tdp: 28 # W
    observations:
      - timestamp: 2023-07-06T00:00 # [KEYWORD] [NO-SUBFIELDS] time when measurement occurred
        duration: 3600 # Secs
        cpu: 18.392
      - mapping:
        units: hour
  app-server:
    pipeline: 
      - teads-curve # tdp & cpu -> energy
      - sci-m # duration & config -> embodied
      - sci-c # energy & grid-carbon-intensity & embodied -> carbon  
    config:
      sci-m:
        te: 1205.52 # kgCO2eq
        tir: duration # get from the duration field
        el: 126144000 # 4 years in seconds    
        rr: 2 # using cores
        tor: 26 # the original report has a typo, says 16 but actually has 26 cores.
      sci-c:
        i: 951 # gCO2e/kWh
      teads-curve:
        processor: Intel® Xeon® Platinum 8272CL
        tdp: 205
    observations:
      - timestamp: 2023-07-06T00:00 # [KEYWORD] [NO-SUBFIELDS] time when measurement occurred
        duration: 3600
        cpu: 18.392
      - mapping:
          units: hour
  db-server:
    pipeline: 
      - teads-curve # tdp & cpu & duration-> energy
      - sci-m # duration & config -> embodied
      - sci-c # energy & grid-carbon-intensity & embodied -> carbon  
    config:
      sci-m:
        te: 1433.12 # kgCO2eq
        tir: duration # get from the duration field
        el: 126144000 # 4 years in seconds    
        rr: 2 # using cores
        tor: 24 # total cores  
      sci-c:
        i: 951
      teads-curve:
        processor:  Intel® Xeon® Platinum 8160
        tdp: 150 # W
    observations:
      - timestamp: 2023-07-06T00:00 # [KEYWORD] [NO-SUBFIELDS] time when measurement occurred
        duration: 3600
        cpu: 10
      - mapping:
        units: hour